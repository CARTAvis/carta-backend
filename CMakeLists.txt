cmake_minimum_required(VERSION 3.5)
project(hdf5_image_viewer)

#set(CMAKE_CXX_COMPILER cc)
set(CMAKE_CXX_STANDARD 11)
set(CMAKE_C_FLAGS "${CMAKE_C_FLAGS} -march=native")
set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -march=native")

add_definitions(-DH5_USE_BOOST)
FIND_PACKAGE(HDF5)
FIND_PACKAGE(HighFive)
FIND_PACKAGE(Boost 1.45 COMPONENTS program_options filesystem REQUIRED)
FIND_PACKAGE(Protobuf REQUIRED)
INCLUDE_DIRECTORIES(${Boost_INCLUDE_DIR})
INCLUDE_DIRECTORIES(${HDF5_INCLUDE_DIR})
INCLUDE_DIRECTORIES(rapidjson)
INCLUDE_DIRECTORIES(${HighFive_INCLUDE_DIR})

ADD_SUBDIRECTORY(proto)
INCLUDE_DIRECTORIES(${CMAKE_CURRENT_BINARY_DIR})
set(LINK_LIBS ${LINK_LIBS} proto ${PROTOBUF_LIBRARY} fmt hdf5_serial uWS ssl crypto z zfp ${Boost_LIBRARIES})
set(SOURCE_FILES main.cc Session.cc compression.cc)
add_executable(hdf5_image_viewer ${SOURCE_FILES})
target_link_libraries(hdf5_image_viewer ${LINK_LIBS})